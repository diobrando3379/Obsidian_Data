```
conda create -n mmlab python=3.11 -y
```

```
conda install pytorch==2.1.2 torchvision==0.16.2 torchaudio==2.1.2 pytorch-cuda=12.1 -c pytorch -c nvidia
```

***

torch、cuda、mmcv的对应关系从mmcv官网看

```
pip install mmcv==2.1.0 -f https://download.openmmlab.com/mmcv/dist/cu121/torch2.1/index.html
```

***

```
pip uninstall -y numpy
pip install numpy==1.26.4
```

```
pip uninstall -y opencv-python opencv-python-headless opencv-contrib-python opencv-contrib-python-headless
pip install "opencv-python<4.10"
```

```
python -c 'import torch;print(torch.__version__)'
```

```
pip install -U openmim
mim install mmengine
```

```
pip uninstall -y opencv-python opencv-python-headless opencv-contrib-python opencv-contrib-python-headless
pip install "opencv-python<4.10"
```

```python
import torch, numpy as np
print("torch:", torch.__version__, "cuda:", torch.version.cuda, "cuda_available:", torch.cuda.is_available())
print("numpy:", np.__version__)
try:
    import cv2
    print("cv2:", cv2.__version__)
except Exception as e:
    print("cv2 import error:", e)
```

```
pip install "mmdet==3.2.0"
```

```
mim install "mmpose>=1.1.0"
```

```python
import mmpose, mmdet, mmcv, mmengine
print("mmpose:", mmpose.__version__)
print("mmdet:", mmdet.__version__)
print("mmcv:", mmcv.__version__)
import mmengine
print("mmengine:", mmengine.__version__)
```

```
git clone https://github.com/open-mmlab/mmaction2.git
```

```
cd mmaction2
pip install -v -e .
```

```
pip uninstall -y numpy
pip install numpy==1.26.4
```

```
pip uninstall -y opencv-python opencv-python-headless opencv-contrib-python opencv-contrib-python-headless
pip install "opencv-python<4.10"
```

***

MMCV的numpy必须要2.0以下，opencv-python的版本对应了numpy的版本，所以也要降级

***

